<app-header-with-back
  [title]="name"
  [showNotificationIcon]="false"
></app-header-with-back>

<ion-content id="mobile-view">
  <div class="row-1">
    <div class="left">
      <h2 class="mb-1">Name: {{dataProvider.currentBooking?.address?.name}}</h2>
      <h2>Address: {{dataProvider.currentBooking?.address?.addressLine1}}</h2>
      <p>
        Phone no.:
        {{(this.dataProvider.currentUser?.user?.phoneNumber)?.substring(3,14)}}
      </p>
      <p>City: {{dataProvider.currentBooking?.address?.city}}</p>
      <p>State: {{dataProvider.currentBooking?.address?.state}}</p>
      <p>Pincode: {{dataProvider.currentBooking?.address?.pincode}}</p>
    </div>
  </div>

  <div class="row-2">
    <div class="top">
      <h2>Select Seva Date</h2>
      <p>Your seva will take approx. {{totalTimeNeeded}}</p>
      <div class="first-btns">
        <button
          *ngFor="let btn of dates"
          (click)="onSelectDate(btn)"
          [ngClass]="{active:selectedDate===btn}"
        >
          {{btn | date:'dd'}}<br />{{btn | date:'E'}}
        </button>
      </div>
      <h2>Select Seva Starting Slot</h2>
      <div class="second-btns" *ngIf="(activeSlotCount > 0); else noSlots">
        <button
          *ngFor="let items of slotsArray"
          (click)="startTime = items.start; endTime = items.end; setSlot(items)"
          [ngClass]="{active:startTime===items.start}"
          [disabled]="getApplicableSlots(items)"
        >
          <ng-container *ngIf="getApplicableSlots(items) else notdisabled">
            <img src="{{slotsIcons[items.index-1].disabled}}" alt="" />
            <div class="slot-det">
              <p style="color: #d7d7d7">{{slotsStatus[items.index-1]}}</p>
              <p style="color: #d7d7d7">
                {{items.start < 12 && items.end> 12 ? items.start + " AM " + '-'
                + (items.end - 12) + " PM " : (items.start > 12 && items.end >
                12 ? (items.start-12) + " PM " + ' - ' + (items.end-12) + " PM "
                : items.start + " AM " + ' - ' + items.end + " AM ")}}
              </p>
            </div>
          </ng-container>

          <ng-template #notdisabled>
            <ng-container
              *ngIf="(startTime === items.start) else notActiveIcon"
            >
              <img src="{{slotsIcons[items.index-1].light}}" alt="" />
              <div class="slot-det light">
                <p>{{slotsStatus[items.index-1]}}</p>
                <p>
                  {{items.start < 12 && items.end> 12 ? items.start + " AM " +
                  '-' + (items.end - 12) + " PM " : (items.start > 12 &&
                  items.end > 12 ? (items.start-12) + " PM " + ' - ' +
                  (items.end-12) + " PM " : items.start + " AM " + ' - ' +
                  items.end + " AM ")}}
                </p>
              </div>
            </ng-container>
            <ng-template #notActiveIcon>
              <img src="{{slotsIcons[items.index-1].dark}}" alt="" />
              <div class="slot-det dark">
                <p>{{slotsStatus[items.index-1]}}</p>
                <p>
                  {{items.start < 12 && items.end> 12 ? items.start + " AM " +
                  '-' + (items.end - 12) + " PM " : (items.start > 12 &&
                  items.end > 12 ? (items.start-12) + " PM " + ' - ' +
                  (items.end-12) + " PM " : items.start + " AM " + ' - ' +
                  items.end + " AM ")}}
                </p>
              </div>
            </ng-template>
          </ng-template>
        </button>
      </div>
      <ng-template #noSlots>
        <div class="no-slot-available">
          <button>No Slot is available</button>
        </div>
      </ng-template>

      <h2 style="margin-top: 20px">Select Seva Start Time</h2>
      <div class="third-btns">
        <button
          *ngFor="let btn of agentArrivalArray"
          (click)="selectAgentArrivalTime = btn; setTimeSlot()"
          [ngClass]="{active:selectAgentArrivalTime===btn}"
        >
          {{btn | date:'hh:mm'}} <br />
          {{btn | date:'aaa'}}
        </button>
      </div>
      <div class="box">
        <img src="assets/icon/select-slot/card.svg" alt="" />
        <p style="color: #fb9f14">
          Free cancellation till 3 hrs before the booked slot, post that ₹100
          chargeable
        </p>
      </div>
    </div>
    <!-- <div class="bottom" (click)="createBooking()">
      <ion-button [disabled]="!(selectedDate && selectedTimeState)" expand="block">
        Book
      </ion-button>
    </div> -->

    <!-- <ng-container *ngIf="this.resData?.mid">
      <form
        name="payment"
        method="POST"
        action="https://pp-checkout.jiopay.com:8443"
        enctype="application/x-www-form-urlencoded"
      >
        <input type="hidden" name="mid" [value]="resData.mid" />
        <input type="hidden" name="appidtoken" [value]="resData.appidtoken" />
        <input
          type="hidden"
          name="appaccesstoken"
          [value]="resData.appaccesstoken"
        />
        <input type="hidden" name="intentid" [value]="resData.intentid" />
        <input
          type="hidden"
          id="brandColor"
          name="brandColor"
          [value]="resData.brandColor"
        />
        <input
          type="hidden"
          id="bodyBgColor"
          name="bodyBgColor"
          [value]="resData.bodyBgColor"
        />
        <input
          type="hidden"
          id="bodyTextColor"
          name="bodyTextColor"
          [value]="resData.bodyTextColor"
        />
        <input
          type="hidden"
          id="headingText"
          name="headingText"
          [value]="resData.headingText"
        />
        <input type="submit" value="Jio Pay" />
      </form>
    </ng-container> -->

    <form
      name="payment"
      method="POST"
      action="https://pp-checkout.jiopay.com:8443"
      enctype="application/x-www-form-urlencoded"
    >
      <input type="hidden" name="mid" value="100001000233342" />
      <input
        type="hidden"
        name="appidtoken"
        value="AW6nGuFcvr9bOsmUJcs4VEIUzL+nmjzIwel5S55MTxkonMckj1FPImL2pn8iUv9Mn7l8MzuJsaXW7q+2HrVqN7pAOrv38WxWzfD01A04o9NkgrVswbyx+bIybvQTkAbCYb4t9oZwT8wnODJXemxA0eFrjcnTyCpsFUL2m+1gZ6srA34WUNfp4LiFrBDJdzuo7L3Twm4KrwuZrtBZW7uPoKAZ2Yd+amzM3TKgWV32Wwyzjbs8IdGMCimiYwPC+fIXzZ2aspHF9spx2irqXGPqxlkiWAFf0lUsMWkXtuWEKDjSBYRjtsyAZMGFtfx14zhyQVtMKAcSfKxpH8dGE8xTLAx98heWjC/pawDZcw9prLOvE4wJaq8KGkShgISgMbQ4Nbv9HoaeevG1b/fSY4NcUpOjvXF4OjJedra34wfK+vInn3DnY/Oal2rkCvTdkVxzkbK9nGh8ozIjLv/iYjoy8Vo3P24FKOa756nAleP7wYyon1fwSOHBJHGrzybBXZN+jBdSWeBIj0cXNPfwJn+cF2KL8/EgQWYptUJm5GEvSt6PtArP5853nlBRc8usLE1mrFqyE6TFyAoUv/FIJ+eA8PBsVUOj2bV9JMD0EYdObwg/xTFqfLBr/aTbFE5dPNUBUQcOLQ3B3182AXPbnp2IjYpjlVTc7qVzkTcmRBQGbeI9GfdyrgvrbinoumBBN6Vmp0iwppWL4wsaP5MwRb3MiG+7UPFNFkxYOkxqevObYdOqtYX6vU1oNzpaqIHI+pksIIp7uCyiZQl3opvd5DAhM/LvQaouNXLmy53zQMi/txqR5LEfvIXPuY0ZxO0cSmXF211ppk9aKHKnvA+6JNxggwrEQ4hAp1XcvRL/fC6VaVjAncbQqMgwWAxql0STW2oEpGIDYKc9kCcZJifN9glXDFrgG8rsOqmz5R9PGksWApbopAj2aMINAVQFO9fliToVUecmnIwmW5CuRohcIn4Z7IYKC165CLaCYSsRMjlEMHl/6OZr7bA1P+3bW5IzyDe6KSWonT0rndFbSiHJ9lZ/MMSNbE1VHExwqiLbV9oLzwlfCERknwGKLks5tWjZQj57cgFojBfW0RYGGVL6L88y/0scMG0NNgQT2qGo42TZc0x0wDBeuBMGceH4bYTuKyhfYqK6NCzJXZW36jexWYVb1/vQUOj+kTzUgFfGYbopmcR4agXF59OYv/ijIFuxbtXwpZclJK4YMKz2KgLU0YYYWMmwRwVyGXEHsynACNZY8gLYB0xn+hwuSKcJT177gp0m"
      />
      <input
        type="hidden"
        name="appaccesstoken"
        value="79219827-111e-41fc-9d38-8c12404a757fAPPACCESS"
      />
      <input type="hidden" name="intentid" value="10452409348782838000" />
      <input type="hidden" id="brandColor" name="brandColor" value="#bcbcbc" />
      <input
        type="hidden"
        id="bodyBgColor"
        name="bodyBgColor"
        value="#ffeede"
      />
      <input
        type="hidden"
        id="bodyTextColor"
        name="bodyTextColor"
        value="#a15814"
      />
      <input
        type="hidden"
        id="headingText"
        name="headingText"
        value="#a15814"
      />
      <input type="submit" value="Jio Pay" />
    </form>

    <div class="temp">
      <div
        class="bottom1"
        *ngIf="!dataProvider.currentBooking?.isReschule || dataProvider.currentBooking?.isReschule === false"
      >
        <button
          class="paynow"
          [ngClass]="{active: (selectedDate && selectedTimeState)}"
          [disabled]="!(selectedDate && selectedTimeState)"
          (click)="createBooking()"
        >
          Pay Now
        </button>
        <button
          class="payafter"
          [ngClass]="{active: (selectedDate && selectedTimeState)}"
          [disabled]="!(selectedDate && selectedTimeState)"
          (click)="createBookingWithoutPay()"
        >
          Pay After Seva
        </button>
      </div>
      <div class="bottom1" *ngIf="dataProvider.currentBooking?.isReschule">
        <button
          class="reschedule"
          [ngClass]="{active: (selectedDate && selectedTimeState)}"
          [disabled]="!(selectedDate && selectedTimeState)"
          (click)="rescheduleBooking()"
        >
          Reschedule
        </button>
      </div>
    </div>
  </div>
</ion-content>

<div class="back-container" id="web-view">
  <div class="main-container">
    <div class="row-1">
      <div class="left">
        <h2 class="mb-1">
          Name: {{dataProvider.currentBooking?.address?.name}}
        </h2>
        <h2>Address: {{dataProvider.currentBooking?.address?.addressLine1}}</h2>
        <p>
          Phone no.:
          {{(this.dataProvider.currentUser?.user?.phoneNumber)?.substring(3,14)}}
        </p>
        <p>City: {{dataProvider.currentBooking?.address?.city}}</p>
        <p>State: {{dataProvider.currentBooking?.address?.state}}</p>
        <p>Pincode: {{dataProvider.currentBooking?.address?.pincode}}</p>
      </div>
    </div>

    <div class="row-2">
      <div class="top">
        <h2>Select Seva Date</h2>
        <p>Your seva will take approx. {{totalTimeNeeded}}</p>
        <div class="first-btns">
          <button
            *ngFor="let btn of dates"
            (click)="onSelectDate(btn)"
            [ngClass]="{active:selectedDate===btn}"
          >
            {{btn | date:'dd'}}<br />{{btn | date:'E'}}
          </button>
        </div>
        <h2>Select Seva Starting Slot</h2>
        <div class="second-btns" *ngIf="(activeSlotCount > 0); else noSlots">
          <button
            *ngFor="let items of slotsArray"
            (click)="startTime = items.start; endTime = items.end; setSlot(items)"
            [ngClass]="{active:startTime===items.start}"
            [disabled]="getApplicableSlots(items)"
          >
            <ng-container *ngIf="getApplicableSlots(items) else notdisabled">
              <img src="{{slotsIcons[items.index-1].disabled}}" alt="" />
              <div class="slot-det">
                <p style="color: #d7d7d7">{{slotsStatus[items.index-1]}}</p>
                <p style="color: #d7d7d7">
                  {{items.start < 12 && items.end> 12 ? items.start + " AM " +
                  '-' + (items.end - 12) + " PM " : (items.start > 12 &&
                  items.end > 12 ? (items.start-12) + " PM " + ' - ' +
                  (items.end-12) + " PM " : items.start + " AM " + ' - ' +
                  items.end + " AM ")}}
                </p>
              </div>
            </ng-container>

            <ng-template #notdisabled>
              <ng-container
                *ngIf="(startTime === items.start) else notActiveIcon"
              >
                <img src="{{slotsIcons[items.index-1].light}}" alt="" />
                <div class="slot-det light">
                  <p>{{slotsStatus[items.index-1]}}</p>
                  <p>
                    {{items.start < 12 && items.end> 12 ? items.start + " AM " +
                    '-' + (items.end - 12) + " PM " : (items.start > 12 &&
                    items.end > 12 ? (items.start-12) + " PM " + ' - ' +
                    (items.end-12) + " PM " : items.start + " AM " + ' - ' +
                    items.end + " AM ")}}
                  </p>
                </div>
              </ng-container>
              <ng-template #notActiveIcon>
                <img src="{{slotsIcons[items.index-1].dark}}" alt="" />
                <div class="slot-det dark">
                  <p>{{slotsStatus[items.index-1]}}</p>
                  <p>
                    {{items.start < 12 && items.end> 12 ? items.start + " AM " +
                    '-' + (items.end - 12) + " PM " : (items.start > 12 &&
                    items.end > 12 ? (items.start-12) + " PM " + ' - ' +
                    (items.end-12) + " PM " : items.start + " AM " + ' - ' +
                    items.end + " AM ")}}
                  </p>
                </div>
              </ng-template>
            </ng-template>
          </button>
        </div>
        <ng-template #noSlots>
          <div class="no-slot-available">
            <button>No Slot is available</button>
          </div>
        </ng-template>

        <h2 *ngIf="agentArrivalArray.length>0" style="margin-top: 20px">
          Select Seva Start Time
        </h2>
        <div class="third-btns">
          <button
            *ngFor="let btn of agentArrivalArray"
            (click)="selectAgentArrivalTime = btn; setTimeSlot()"
            [ngClass]="{active:selectAgentArrivalTime===btn}"
          >
            {{btn | date:'hh:mm'}} <br />
            {{btn | date:'aaa'}}
          </button>
        </div>
        <div class="box">
          <img src="assets/icon/select-slot/card.svg" alt="" />
          <p style="color: #fb9f14">
            Free cancellation till 3 hrs before the booked slot, post that ₹100
            chargeable
          </p>
        </div>
      </div>
      <!-- <div class="bottom" (click)="createBooking()">
        <ion-button [disabled]="!(selectedDate && selectedTimeState)" expand="block">
          Book
        </ion-button>
      </div> -->

      <div class="temp">
        <div
          class="bottom1"
          *ngIf="!dataProvider.currentBooking?.isReschule || dataProvider.currentBooking?.isReschule === false"
        >
          <button
            class="paynow"
            [ngClass]="{active: (selectedDate && selectedTimeState)}"
            [disabled]="!(selectedDate && selectedTimeState)"
            (click)="createBooking()"
          >
            Pay Now
          </button>
          <button
            class="payafter"
            [ngClass]="{active: (selectedDate && selectedTimeState)}"
            [disabled]="!(selectedDate && selectedTimeState)"
            (click)="createBookingWithoutPay()"
          >
            Pay After Seva
          </button>
        </div>
        <div class="bottom1" *ngIf="dataProvider.currentBooking?.isReschule">
          <button
            class="reschedule"
            [ngClass]="{active: (selectedDate && selectedTimeState)}"
            [disabled]="!(selectedDate && selectedTimeState)"
            (click)="rescheduleBooking()"
          >
            Reschedule
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
